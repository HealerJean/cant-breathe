@ECHO OFF
for /f "skip=3 tokens=4" %%i in ('sc query OracleServiceORCL') do set "zt=%%i" &goto :next
:next
if /i "%zt%"=="RUNNING" (
ECHO Stoping OracleService, please wait ...
net stop OracleVssWriterORCL
net stop OracleDBConsoleorcl
net stop OracleMTSRecoveryService
net stop OracleOraDb11g_home1ClrAgent
net stop OracleOraDb11g_home1TNSListener
net stop OracleServiceORCL
)else (
ECHO Starting OracleService, please wait ...
net start OracleVssWriterORCL
net start OracleDBConsoleorcl
net start OracleMTSRecoveryService
net start OracleOraDb11g_home1ClrAgent
net start OracleOraDb11g_home1TNSListener
net start OracleServiceORCL
)
pause
exit